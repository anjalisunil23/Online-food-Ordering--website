<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Foodie - Cart</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Segoe UI,sans-serif;}
body{background:#fff5ed;color:#222;}
header{background:linear-gradient(90deg,#ff512f,#ff914d);padding:14px 24px;color:#fff;display:flex;justify-content:space-between;align-items:center;}
.logo{font-size:24px;font-weight:800;color:#fff;text-decoration:none;display:flex;gap:10px;align-items:center;}
nav{display:flex;gap:14px;align-items:center;}
nav a{color:#fff;text-decoration:none;font-weight:600;}
.container{max-width:960px;margin:24px auto;padding:0 16px;}
h1{color:#ff512f;margin-bottom:14px;}
.table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 8px 16px rgba(0,0,0,.08);}
.table th,.table td{padding:12px;border-bottom:1px solid #f0f0f0;text-align:left;}
.table th{background:#ffefe5;color:#b6411f;}
.qty-wrap{display:flex;gap:8px;align-items:center;}
.qty-btn{width:28px;height:28px;border:1px solid #ddd;background:#fff;border-radius:6px;cursor:pointer;}
.remove{background:#ef4444;color:#fff;border:none;padding:8px 10px;border-radius:6px;cursor:pointer;}
.summary{margin-top:18px;background:#fff;border-radius:12px;padding:14px;box-shadow:0 8px 16px rgba(0,0,0,.08);}
.row{display:flex;justify-content:space-between;padding:8px 0;}
.total{font-weight:800;color:#ff512f;font-size:20px;}
.actions{display:flex;gap:12px;margin-top:14px;}
.btn{padding:10px 14px;border:none;border-radius:8px;cursor:pointer;text-decoration:none;display:inline-block;font-weight:700;}
.btn-primary{background:#ff512f;color:#fff;}
.btn-secondary{background:#fff;border:1px solid #ff512f;color:#ff512f;}
.empty{background:#fff;padding:24px;border-radius:12px;box-shadow:0 8px 16px rgba(0,0,0,.08);text-align:center;color:#666;}
</style>
</head>
<body>
<header>
  <a class="logo" href="homepage.html"><span>üçî</span><span>Foodie</span></a>
  <nav>
    <a href="homepage.html">Home</a>
    <a href="menu.html">Menu</a>
    <a href="offers.html">Offers</a>
    <a href="login.html">Login</a>
  </nav>
</header>

<div class="container">
  <h1>üõí Your Cart</h1>
  <div id="content"></div>
</div>

<script>
function getCart(){
  return JSON.parse(localStorage.getItem('cart')) || [];
}

function setCart(cart){
  localStorage.setItem('cart', JSON.stringify(cart));
}

function renderCart(){
  const cart = getCart();
  const content = document.getElementById('content');

  if (!Array.isArray(cart) || cart.length === 0) {
    content.innerHTML = `
      <div class="empty">
        <p>Your cart is empty.</p>
        <div style="margin-top:12px;"><a class="btn btn-primary" href="menu.html">Go to Menu</a></div>
      </div>`;
    return;
  }

  let subtotal = 0;
  const rows = cart.map((item, index) => {
    const quantity = Math.max(1, Number(item.quantity || 1));
    const price = Math.max(0, Number(item.price || 0));
    const line = price * quantity;
    subtotal += line;
    return `
      <tr>
        <td>${item.name || 'Item'}</td>
        <td>‚Çπ${price}</td>
        <td>
          <div class="qty-wrap">
            <button class="qty-btn" onclick="updateQty(${index},-1)">-</button>
            <span>${quantity}</span>
            <button class="qty-btn" onclick="updateQty(${index},1)">+</button>
          </div>
        </td>
        <td>‚Çπ${line}</td>
        <td><button class="remove" onclick="removeItem(${index})">Remove</button></td>
      </tr>`;
  }).join('');

  const delivery = subtotal > 0 ? 40 : 0;
  const total = subtotal + delivery;

  content.innerHTML = `
    <table class="table">
      <thead>
        <tr><th>Item</th><th>Price</th><th>Qty</th><th>Total</th><th>Action</th></tr>
      </thead>
      <tbody>${rows}</tbody>
    </table>
    <div class="summary">
      <div class="row"><span>Subtotal</span><strong>‚Çπ${subtotal}</strong></div>
      <div class="row"><span>Delivery</span><strong>‚Çπ${delivery}</strong></div>
      <div class="row total"><span>Grand Total</span><span>‚Çπ${total}</span></div>
      <div class="actions">
        <a class="btn btn-secondary" href="menu.html">Continue Shopping</a>
        <button class="btn btn-primary" onclick="checkout(${subtotal},${delivery},${total})">Checkout</button>
      </div>
    </div>`;
}

function updateQty(index, delta){
  const cart = getCart();
  if (!cart[index]) return;
  const current = Math.max(1, Number(cart[index].quantity || 1));
  const updated = current + delta;
  if (updated <= 0) {
    cart.splice(index, 1);
  } else {
    cart[index].quantity = updated;
  }
  setCart(cart);
  renderCart();
}

function removeItem(index){
  const cart = getCart();
  if (!cart[index]) return;
  cart.splice(index, 1);
  setCart(cart);
  renderCart();
}

function checkout(subtotal, delivery, total){
  const cart = getCart();
  if (!Array.isArray(cart) || cart.length === 0) {
    alert('Cart is empty.');
    return;
  }

  if (total <= 0 || subtotal < 0 || delivery < 0) {
    alert('Invalid total. Please refresh cart.');
    return;
  }

  const order = {
    id: 'FD' + Date.now(),
    date: new Date().toLocaleString(),
    subtotal,
    delivery,
    total,
    items: cart.map((item) => ({
      name: item.name,
      price: Number(item.price || 0),
      quantity: Math.max(1, Number(item.quantity || 1))
    }))
  };

  localStorage.setItem('order', JSON.stringify(order));
  localStorage.removeItem('cart');
  window.location.href = 'receipt.html';
}

renderCart();
</script>
</body>
</html>
